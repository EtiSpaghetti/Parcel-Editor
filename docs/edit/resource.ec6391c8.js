const e=RegExp("^[a-z]([a-z_]*[a-z])?$"),t=RegExp("^[a-zA-Z](?:[a-zA-Z ]*[a-zA-Z])?$"),r=RegExp("^(resource|structure|research|unique|interaction|event):(([a-z]([a-z_]*[a-z])?))$");class n{init(){console.log(`Parcel Editor Version 7.1.4 - Starting up.
Loading ${this.editorType} editor - Version ${this.editorVersion}`),this.checkStorage(),this.logStorageCount(),this.logStorage()}update(){this.checkStorage()}checkStorage(){this.parcels=[];for(let e=0;e<localStorage.length;e++)r.test(localStorage.key(e))&&this.parcels.push(localStorage.key(e));this.sortStorage()}sortStorage(){this.parcels.sort((e,t)=>e.localeCompare(t)),this.resources=this.parcels.filter(e=>e.startsWith("resource:")),this.structures=this.parcels.filter(e=>e.startsWith("structure:")),this.research=this.parcels.filter(e=>e.startsWith("research:")),this.unique=this.parcels.filter(e=>e.startsWith("unique:")),this.interactions=this.parcels.filter(e=>e.startsWith("interaction:")),this.events=this.parcels.filter(e=>e.startsWith("event:"))}logStorage(){console.table({Resources:this.resources,Structures:this.structures,Research:this.research,Unique:this.unique,Interactions:this.interactions,Events:this.events})}logStorageCount(){console.table({Total:[this.parcels.length],Resources:[this.resources.length],Structures:[this.structures.length],Research:[this.research.length],Unique:[this.unique.length],Interactions:[this.interactions.length],Events:[this.events.length]})}save(){if(!this.checkValidToSave())return console.warn("Parcel is not valid and cannot be saved"),!1;let e=`${this.editorType}:${this.current.id}`;return this.saveTimeout&&clearTimeout(this.saveTimeout),localStorage.setItem(e,JSON.stringify(this.current)),this.isSaved=!0,this.updateSaveStatus(),console.info(`Saved ${e}`),!0}checkValidToSave(){if(void 0===this.current)return console.warn("No parcel loaded, not saving"),!1;let e=`${this.editorType}:${this.current.id}`;return!!r.test(e)||(console.warn(`Given invalid full ID: ${e} to save`),!1)}delayedSave(){this.isSaved=!1,this.saveTimeout&&clearTimeout(this.saveTimeout),this.saveTimeout=window.setTimeout(()=>{this.save()},5e3),this.updateSaveStatus()}confirmChangestateSave(){return void 0===this.current||!!this.save()||!!confirm("Unable to save, are you sure you would like to continue?")}load(e){if(!this.confirmChangestateSave())return!1;if(!1===r.test(e))return console.warn(`Given invalid full ID: ${e} to load`),!1;if(!1===e.startsWith(this.editorType))return console.warn(`Given wrong editor type: ${e} to load
 Expected: ${this.editorType}`),!1;let t=JSON.parse(localStorage.getItem(e));if(null===t)return console.warn(`Given parcel doesn't exist: ${e} to load`),!1;let n=this.generateEmptyParcel(t.id,"Undefined Name");return Object.assign(n,t),this.current=n,!0}delete(e){return!1===r.test(e)?(console.warn(`Given invalid full ID: ${e} to delete`),!1):(void 0!==this.current&&`${this.current.type}:${this.current.id}`===e&&(this.current=void 0,this.clearRender()),localStorage.removeItem(e),console.log(`Deleted ${e}`),this.update(),!0)}registerInvalid(e){return!1===r.test(e)?(console.warn(`Given invalid full ID: ${e} to register as invalid`),!1):(JSON.parse(localStorage.getItem("editor_knownInvalids")||"[]").push([e,!0]),!0)}generateTextInput(e,t,r=[]){let n=document.createElement("div"),i=document.createElement("label");i.innerHTML=t;let s=document.createElement("input");return s.value=this.current[e],s.addEventListener("input",()=>{this.current[e]=s.value,this.delayedSave()}),r.includes("spellcheck")&&(s.spellcheck=!0),r.includes("notEmpty")&&(s.minLength=1,s.required=!0),r.includes("readonly")&&(s.readOnly=!0),r.includes("regexId")?s.pattern="[a-z]([a-z_]*[a-z])?":r.includes("regexName")&&(s.pattern="[a-zA-Z](?:[a-zA-Z ]*[a-zA-Z])?"),n.appendChild(i),n.appendChild(s),n}generateTextArea(e,t,r=[]){let n=document.createElement("div"),i=document.createElement("label");i.innerHTML=t;let s=document.createElement("textarea");return s.value=this.current[e],s.rows=4,s.addEventListener("input",()=>{this.current[e]=s.value,this.delayedSave()}),r.includes("spellcheck")&&(s.spellcheck=!0),r.includes("notEmpty")&&(s.minLength=1,s.required=!0),r.includes("readonly")&&(s.readOnly=!0),n.appendChild(i),n.appendChild(s),n}generateNumberInput(e,t,r=[]){let n=document.createElement("div"),i=document.createElement("label");i.innerHTML=t;let s=document.createElement("input");return s.type="number",s.value=this.current[e],s.addEventListener("input",()=>{this.current[e]=Number(s.value),this.delayedSave()}),r.includes("notNegative")?s.min="0":r.includes("notZero")&&(s.min="1"),r.includes("notEmpty")&&(s.required=!0),n.appendChild(i),n.appendChild(s),n}generateDeleteButton(e){let t=document.createElement("div");t.className="delete";let r=document.createElement("button");return r.innerHTML="Delete",r.addEventListener("click",()=>{this.delete(e)}),t.append(r),t}constructor(){this.isSaved=!0,this.parcels=[],this.resources=[],this.structures=[],this.research=[],this.unique=[],this.interactions=[],this.events=[]}}const i=document.getElementById("resource_add_id"),s=document.getElementById("resource_add_button"),a=document.getElementById("show_panel"),l=document.getElementById("resource_information"),o=document.getElementById("saved_indicator"),c=new class extends n{init(){super.init(),this.renderResourcePanel(),this.updateSaveStatus()}update(){super.update(),this.renderResourcePanel(),this.updateSaveStatus()}generateEmptyParcel(e,t){return{id:e,type:"resource",name:t,description:"",symbol:"",minvalue:0,maxvalue:0,onUnlock:[],onReach:[]}}create(){return this.confirmChangestateSave()?e.test(i.value)?(this.current=this.generateEmptyParcel(i.value,i.value.replace("_"," ")),i.value="",this.save(),console.log(`Created ${this.current.id}`),this.update(),!0):(alert("Invalid ID"),!1):(console.log("Cannot create parcel, was unable to save currently loaded parcel"),!1)}updateSaveStatus(){this.isSaved?o.className="saved":o.className="unsaved"}checkValidToSave(){return!!super.checkValidToSave()&&(e.test(this.current.id)?!!t.test(this.current.name)||(console.warn(`Given invalid Name: ${this.current.name} to save`),!1):(console.warn(`Given invalid ID: ${this.current.id} to save`),!1))}clearRender(){a.innerHTML="",l.innerHTML="",this.renderResourcePanel()}renderResourcePanel(){a.innerHTML="";for(let e=0;e<this.resources.length;e++){let t=document.createElement("button");t.innerHTML=this.resources[e],t.addEventListener("click",()=>{console.log(this.resources[e]),this.load(this.resources[e]),this.renderResouceInformation()}),a.appendChild(t)}}renderResouceInformation(){if(void 0===this.current){console.warn("No resource loaded");return}l.innerHTML="";let e=document.createElement("div");e.id="tlpanel";let t=document.createElement("div");t.id="trpanel";let r=document.createElement("div");r.id="bpanel",e.appendChild(this.generateTextInput("id","ID",["notEmpty","regexId","readonly"])),e.appendChild(this.generateTextInput("name","Name",["spellcheck","notEmpty","regexName"])),e.appendChild(this.generateTextInput("symbol","Symbol")),e.appendChild(this.generateTextArea("description","Description",["spellcheck"])),e.appendChild(this.generateNumberInput("minvalue","Min Value",["notEmpty"])),e.appendChild(this.generateNumberInput("maxvalue","Max Value",["notEmpty"])),r.appendChild(this.generateDeleteButton(`${this.current.type}:${this.current.id}`)),l.appendChild(e),l.appendChild(t),l.appendChild(r)}constructor(...e){super(...e),this.editorType="resource",this.editorVersion=1}};c.init(),window.editor=c,i.addEventListener("input",()=>{""===i.value?i.classList.add("empty"):i.classList.remove("empty")}),s.addEventListener("click",()=>{c.create()}),o.addEventListener("click",()=>{c.save()});
//# sourceMappingURL=resource.ec6391c8.js.map
